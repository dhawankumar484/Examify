<section class="container max-w-4xl bg-white shadow-lg rounded px-5 my-5 pb-5">
    <div class="py-5">
        <h4 class="text-2xl fw-bold mb-4 text-center">Write Question and Select type of Question</h4>
    </div>

    <form [formGroup]="questionForm">

        <div formArrayName="questions" *ngFor="let question of questions.controls; let i = index" class="mt-3">
            <ng-container [formGroupName]="i">
                <div *ngIf="i>0 || questions.controls.length>1" (click)="deleteQuestions(i)" class="col-lg-12 text-end text-danger h-20 bg-transparent mx-2 px-2 cursor-pointer">
                    <u>Delete</u>
                </div>
                <h6 class="text-2xl">Question {{i+1}}</h6>
                <textarea class="form-control" formControlName="question" placeholder="Write Question here" [rows]="1" id="floatingTextarea" #question></textarea>
                <div *ngIf="f[i].get('question')?.errors?.['required'] && (f[i].get('question')?.touched || f[i].get('question')?.dirty)" class="text-danger">
                    Question {{i+1}} is required.
                </div>
                <h6 class="text-2xl mt-3">Select type of Answer</h6>
                <div class="row">
                    <div class="col-12 col-md-4 col-lg-3 custom-control custom-radio mt-2 mt-md-0">
					    <input type="radio" formControlName="type" class="custom-control-input" value="input" ngModel (click)="addLineInput(i)">
                        <label style="margin-left: 8px;" class="form-check-label custom-control-label" for="input">Input</label>
                        <div class="mt-2" *ngIf="questions.controls[i].value.type=='input'">
                            <input type="number" formControlName="numberOfLine" class="form-control" placeholder="Add number of line">
                        </div>
                        <div *ngIf="f[i].get('numberOfLine')?.errors?.['required'] && (f[i].get('numberOfLine')?.touched || f[i].get('numberOfLine')?.dirty)" class="text-danger">
                            Number of Input Lines is required.
                        </div>
                        <div *ngIf="f[i].get('numberOfLine')?.errors?.['min'] && (f[i].get('numberOfLine')?.touched || f[i].get('numberOfLine')?.dirty)" class="text-danger">
                            Minimum Options should not be less than 2.
                        </div>
                        <div *ngIf="f[i].get('numberOfLine')?.errors?.['max'] && (f[i].get('numberOfLine')?.touched || f[i].get('numberOfLine')?.dirty)" class="text-danger">
                            Maximum Options should not be more than 10.
                        </div>
                    </div>

                    <div class="col-12 col-md-4 col-lg-3 custom-control custom-radio mt-2 mt-md-0">
                        <input type="radio" formControlName="type" class="custom-control-input" value="multiple" ngModel (click)="addNumberOfOption(i)">
                        <label style="margin-left: 8px;" class="form-check-label custom-control-label" for="multiple">Multiple Choice</label>
                        <div class="mt-2" *ngIf="questions.controls[i].value.type=='multiple'" max (keyup)="addOptionFields($event, i)">
                            <input type="number" formControlName="numberOfOption" class="form-control" placeholder="Add number of options">
                        </div>
                        <div *ngIf="f[i].get('numberOfOption')?.errors?.['required'] && (f[i].get('numberOfOption')?.touched || f[i].get('numberOfOption')?.dirty)" class="text-danger">
                            Number of Options is required.
                        </div>
                        <div *ngIf="f[i].get('numberOfOption')?.errors?.['min'] && (f[i].get('numberOfOption')?.touched || f[i].get('numberOfOption')?.dirty)" class="text-danger">
                            Minimum Options should not be less than 2.
                        </div>
                        <div *ngIf="f[i].get('numberOfOption')?.errors?.['max'] && (f[i].get('numberOfOption')?.touched || f[i].get('numberOfOption')?.dirty)" class="text-danger">
                            Maximum Options should not be more than 10.
                        </div>
                    </div>

                    <div class="col-12 col-md-4 col-lg-3 custom-control custom-radio mt-2 mt-md-0">
                        <input type="radio" formControlName="type" class="custom-control-input" value="binary" ngModel (click)="selectOther(i)">
                        <label style="margin-left: 8px;" class="form-check-label custom-control-label" for="binary">True/False</label>
                    </div>

                    <div class="col-12 col-md-4 col-lg-3 custom-control custom-radio mt-2 mt-md-0">
                        <input type="radio" formControlName="type" class="custom-control-input" value="no_answer" ngModel (click)="selectOther(i)">
                        <label style="margin-left: 8px;" class="form-check-label custom-control-label" for="no_answer">No Answer</label>
                    </div>
                </div>
                <div *ngIf="f[i].get('type')?.errors?.['required'] && (f[i].get('type')?.touched || f[i].get('type')?.dirty)" class="text-danger">
                    Answer Type is required.
                </div>

                <div class="row my-3">
                    <div *ngFor="let option of getOptionArray(numberOfOptions[i]); index as j" class="col-12 col-md-5 com-lg-4">
                        <h6 class="text-2xl mt-3">Option {{j+1}}</h6>
                        <input type="text" [formControlName]="'option' + (j+1)" class="form-control" [placeholder]="'Enter option ' + (j+1)">
                        <div *ngIf="f[i].get('option' + (j+1))?.errors?.['required'] && (f[i].get('option' + (j+1))?.touched || f[i].get('option' + (j+1))?.dirty)" class="text-danger">
                            Option {{j+1}} is required.
                        </div>
                    </div>
                </div>
                <hr class="my-4" *ngIf="i<questions.controls.length-1">
            </ng-container>
        </div>

        <div class="col-lg-12 text-danger text-end fw-bold bg-transparent mt-3 p-0">
            <u (click)="addQuestion()" class="cursor-pointer">+ Add</u> 
        </div>

        <!-- Submit Button -->
        <div class="col-12 justify-content-end text-end mt-5">
            <button type="submit" class="btn btn-primary btn-lg btn-block" (click)="submit()">Submit Questions</button>
        </div>
    </form>
</section>